

<app-mabo-navbar></app-mabo-navbar>


<!-- page -->
<div class="browse-page">
  <div class="browse-layout">

    <!-- LEFT SIDEBAR -->
    <aside class="sidebar">

      <div class="panel">
        <div class="panel-title">SORT BY</div>

        <select class="select" [(ngModel)]="sort" (change)="onSortChanged();">
          <option value="recent">Release Date: Recent â†’ Old</option>
          <option value="priceAsc">Price: Low â†’ High</option>
          <option value="priceDesc">Price: High â†’ Low</option>
          <option value="nameAsc">Name: A â†’ Z</option>
          <option value="nameDesc">Name: Z â†’ A</option>
        </select>
      </div>

      <div class="panel">
        <div class="panel-title-row">
          <span>GENRES</span>
          <span class="muted"> {{ selectedGenreIds.size }}</span>
        </div>

        <div class="genre-list">
          <label class="genre-item" *ngFor="let g of genres">
            <input
              type="checkbox"
              [checked]="isGenreSelected(g.id)"
              (change)="toggleGenre(g.id)"
            />
            <span class="genre-name">{{ g.name }}</span>
          </label>
        </div>

        <button
          class="btn-clear"
          type="button"
          (click)="clearGenres()"
          *ngIf="selectedGenreIds.size > 0"
        >
          Clear
        </button>
      </div>

    </aside>

    <!-- MAIN -->
    <main class="content"> 
      <header class="browse-header">
        <h1>Browse Games</h1>
        <p>Find your next game by genre, search, and sorting.</p>
      </header>

      <section class="payment-notice" *ngIf="paymentNoticeVisible">
        <div>
          <strong>Payment successful.</strong> Your order is confirmed and marked as paid.
        </div>
        <button type="button" class="payment-notice-close" (click)="closePaymentNotice()">Dismiss</button>
      </section>

      <div class="top-row">
        <div class="spacer"></div>

        <div class="search">
          <span class="search-icon">ðŸ”Ž</span>
          <input
            class="search-input"
            type="text"
            placeholder="Search for games..."
            [(ngModel)]="search"
            (input)="onSearchChanged()"
          />
        </div>
      </div>

      <!-- Grid -->
      <div class="games-grid" *ngIf="filteredGames.length > 0; else empty">
        <a
          class="game-card"
          *ngFor="let g of filteredGames"
          [routerLink]="['/public/games', g.id]"
        >
          <img class="game-card-img" [src]="getGameImage(g)" [alt]="g.name" />

          <div class="game-card-meta">
            <div class="game-card-title">{{ g.name }}</div>
            <div class="game-card-sub">{{ g.publisherName }}</div>

            <div class="game-card-bottom">

              <div class="game-card-price">
                {{ g.price | number:'1.2-2' }} KM
              </div>
            </div>
          </div>
        </a>
      </div>

      <ng-template #empty>
        <div class="empty">
          No games found.
        </div>
      </ng-template>

      <!-- Pagination -->
      <div class="pager" *ngIf="totalPages > 1">
        <button class="pager-btn" (click)="goToPage(page-1)" [disabled]="page <= 1">â€¹</button>

        <button
          class="pager-num"
          *ngFor="let p of pageNumbers"
          (click)="goToPage(p)"
          [class.active]="p === page"
        >
          {{ p }}
        </button>

        <button class="pager-btn" (click)="goToPage(page+1)" [disabled]="page >= totalPages">â€º</button>
      </div>

    </main>
  </div>
  
<app-mabo-footer></app-mabo-footer>

</div>
